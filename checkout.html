<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Checkout - Maison Doucette</title>

<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@300;400&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0;}

body{
    font-family:'Inter', sans-serif;
    background:linear-gradient(135deg,#f5efe6,#e6d5c3);
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:center;
    padding:20px;
}

.checkout-container{
    width:100%;
    max-width:900px;
    background:#fffdf9;
    padding:50px;
    border-radius:20px;
    box-shadow:0 20px 60px rgba(0,0,0,0.15);
}

h2{
    font-family:'Playfair Display', serif;
    font-size:32px;
    margin-bottom:30px;
    color:#4b2e2b;
    text-align:center;
}

h3{
    margin-top:30px;
    font-family:'Playfair Display', serif;
    color:#4b2e2b;
}

.cart-item{
    background:#faf6f0;
    padding:15px;
    border-radius:15px;
    margin-top:15px;
    position:relative;
    display:flex;
    gap:15px;
}

.cart-item img{
    width:80px;
    height:80px;
    object-fit:cover;
    border-radius:10px;
}

.cart-details{
    flex:1;
    font-size:14px;
}

.cart-details p{margin:3px 0;}

.remove-item{
    position:absolute;
    top:10px;
    right:12px;
    cursor:pointer;
    font-size:18px;
    color:#8c6f63;
}

.remove-item:hover{color:#5a3e36;}

.qty-controls{
    margin-top:8px;
}

.qty-controls button{
    width:28px;
    height:28px;
    padding:0;
    border-radius:50%;
    font-size:16px;
    margin:0 5px;
}

.empty-cart{
    margin-top:20px;
    font-style:italic;
    color:#8c6f63;
}

label{
    display:block;
    margin-top:20px;
    font-size:14px;
    color:#5a3e36;
}

input, select, textarea{
    width:100%;
    padding:12px;
    margin-top:8px;
    border-radius:10px;
    border:1px solid #d6c4b2;
    background:#faf6f0;
}

textarea{resize:none;height:100px;}

.summary{
    margin-top:30px;
    padding:20px;
    background:#f3e8dc;
    border-radius:15px;
}

.summary p{margin:6px 0;}

.total{
    font-weight:bold;
    font-size:18px;
    margin-top:10px;
}

button{
    margin-top:30px;
    width:100%;
    padding:14px;
    border:none;
    border-radius:12px;
    background:#5a3e36;
    color:white;
    font-size:16px;
    cursor:pointer;
}

button:disabled{
    background:#c5b7aa;
    cursor:not-allowed;
}

#loadingMessage{
    display:none;
    margin-top:15px;
    text-align:center;
    font-style:italic;
    color:#5a3e36;
}
</style>
</head>
<body>

<div class="checkout-container">
<h2>Complete your order</h2>

<h3>Your Cart</h3>
<div id="cartItems"></div>
<p id="emptyCartMessage" class="empty-cart" style="display:none;">
Your cart is currently empty ü§ç
</p>

<form id="checkout-form">

<label>Full Name</label>
<input type="text" name="name" required>

<label>Email</label>
<input type="email" name="email" required>

<label>Phone Number</label>
<input type="text" name="phone" required>

<label>Delivery Address</label>
<input type="text" name="address" required>

<label>Shipping Method</label>
<select name="delivery" required>
<option value="">Select shipping</option>
<option value="Standard (15 RON)">Standard (15 RON)</option>
<option value="Express (18 RON)">Express (18 RON)</option>
<option value="Local Pickup - Gala»õi (Free)">Local Pickup - Gala»õi (Free)</option>
</select>

<label>Payment Method</label>
<select name="payment" required>
<option value="">Select payment method</option>
<option value="Cash on Delivery">Cash on Delivery</option>
<option value="Bank Transfer">Bank Transfer</option>
<option value="Card (on delivery)">Card (on delivery)</option>
</select>

<label>Additional Notes <span style="font-size:12px;font-weight:normal;">(optional)</span></label>
<textarea name="notes"></textarea>

<div class="summary">
<p>Subtotal: <span id="subtotal">0</span> RON</p>
<p>Shipping: <span id="shipping">0</span> RON</p>
<p class="total">Total: <span id="total">0</span> RON</p>
</div>

<button type="submit" id="placeOrderBtn" disabled>Place Order</button>
<p id="loadingMessage">Your handmade piece is being prepared with care ü§ç</p>

</form>
</div>

<script>
(function(){ emailjs.init("uXq_doL-7YdoXPSfK"); })();

let cart = JSON.parse(localStorage.getItem("cart")) || [];
let subtotal = 0;
let shippingCost = 0;

function renderCart(){
    const container = document.getElementById("cartItems");
    const emptyMsg = document.getElementById("emptyCartMessage");
    container.innerHTML="";
    subtotal=0;

    if(cart.length===0){
        emptyMsg.style.display="block";
    }else{
        emptyMsg.style.display="none";
    }

    cart.forEach((item,index)=>{
        subtotal+=item.price*item.quantity;

        container.innerHTML+=`
        <div class="cart-item">
            <span class="remove-item" onclick="removeItem(${index})">‚úï</span>
            ${item.image ? `<img src="${item.image}">` : ""}
            <div class="cart-details">
                <strong>${item.name}</strong>
                <p>${item.price} RON x ${item.quantity}</p>

                ${item.material ? `<p>Material: ${item.material}</p>`:""}
                ${item.size ? `<p>Size: ${item.size}</p>`:""}
                ${item.bodyColor ? `<p>Body Colour: ${item.bodyColor}</p>`:""}

                ${item.baseColor ? `<p>Strawberry Colour: ${item.baseColor}</p>`:""}
                ${item.chocolateColor ? `<p>Chocolate Colour: ${item.chocolateColor}</p>`:""}

                ${item.accessory ? `<p>Accessory: ${item.accessory}</p>`:""}
                ${item.heartColor ? `<p>Heart Colour: ${item.heartColor}</p>`:""}
                ${item.starColor ? `<p>Star Colour: ${item.starColor}</p>`:""}
                ${item.bowColor ? `<p>Bow Colour: ${item.bowColor}</p>`:""}

                <div class="qty-controls">
                    <button type="button" onclick="changeQty(${index},-1)">-</button>
                    <button type="button" onclick="changeQty(${index},1)">+</button>
                </div>
            </div>
        </div>`;
    });

    document.getElementById("subtotal").innerText=subtotal;
    document.getElementById("total").innerText=subtotal+shippingCost;

    validateCheckout();
}

function changeQty(index,delta){
    cart[index].quantity+=delta;
    if(cart[index].quantity<=0) cart.splice(index,1);
    localStorage.setItem("cart",JSON.stringify(cart));
    renderCart();
}

function removeItem(index){
    cart.splice(index,1);
    localStorage.setItem("cart",JSON.stringify(cart));
    renderCart();
}

document.querySelector("select[name='delivery']").addEventListener("change",function(){
    if(this.value.includes("Standard")) shippingCost=15;
    else if(this.value.includes("Express")) shippingCost=18;
    else shippingCost=0;
    document.getElementById("shipping").innerText=shippingCost;
    document.getElementById("total").innerText=subtotal+shippingCost;
    validateCheckout();
});

function validateCheckout(){
    const requiredFields=document.querySelectorAll(
    "input[name='name'], input[name='email'], input[name='phone'], input[name='address'], select[name='delivery'], select[name='payment']"
    );

    let allFilled=true;

    requiredFields.forEach(field=>{
        if(field.value.trim()===""){
            allFilled=false;
        }
    });

    const cartNotEmpty=cart.length>0;

    document.getElementById("placeOrderBtn").disabled=!(allFilled && cartNotEmpty);
}

document.querySelectorAll(
"input[name='name'], input[name='email'], input[name='phone'], input[name='address'], select[name='delivery'], select[name='payment']"
).forEach(field=>{
    field.addEventListener("input",validateCheckout);
    field.addEventListener("change",validateCheckout);
});

renderCart();
</script>

</body>
</html>
